<!-- PÁGINA 2: Visualização de Tickets Recebidos (Kanban simples) -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel de Tickets - Nortelab</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .kanban { display: flex; gap: 15px; }
    .coluna { border: 1px solid #ccc; padding: 10px; width: 20%; }
    .coluna h3 { text-align: center; }
    .ticket { background: #f0f0f0; padding: 10px; margin: 5px 0; border-left: 5px solid #007bff; }
  </style>
</head>
<body>
  <h2>Painel de Acompanhamento de Tickets</h2>
  <div class="kanban">
    <div class="coluna" id="Solicitado">
      <h3>Solicitado</h3>
    </div>
    <div class="coluna" id="Recebido">
      <h3>Recebido</h3>
    </div>
    <div class="coluna" id="Em processo">
      <h3>Em processo</h3>
    </div>
    <div class="coluna" id="Finalizado">
      <h3>Finalizado</h3>
    </div>
    <div class="coluna" id="Reagendado">
      <h3>Reagendado</h3>
    </div>
  </div>

  <script>
    const planilhaUrl = 'https://docs.google.com/spreadsheets/d/1jIk2DnDYh9FlrZP0lyCWdyOFNqxiVofMrf9VZS6Bwik/gviz/tq?tqx=out:json';

    fetch(planilhaUrl)
      .then(res => res.text())
      .then(data => {
        const json = JSON.parse(data.substr(47).slice(0, -2));
        const linhas = json.table.rows;
        linhas.forEach(l => {
          const protocolo = l.c[0]?.v || "";
          const nome = l.c[1]?.v || "";
          const setor = l.c[2]?.v || "";
          const status = l.c[10]?.v || "Solicitado";
          const el = document.createElement('div');
          el.className = 'ticket';
          el.innerHTML = `<strong>${protocolo}</strong><br>${nome}<br>${setor}`;
          document.getElementById(status)?.appendChild(el);
        });
      });
  </script>
</body>
</html>
